# Gene Set Enrichment Workflow

This repository contains utilities for pathway and gene-set enrichment, visualization, and biological interpretation. The R functions included in `Enrichment_analysis_functions.R` are designed to perform gene set enrichment analysis across multiple comparisons and improve the biological interpretability of results. The workflow allows grouping pathways into predefined biological categories and visualizing multiple comparisons at once, making it easier to interpret complex data.

The R Markdown file `Workflow_enrichment.Rmd` included in this repository illustrates a complete example of the workflow, and the corresponding HTML file `Workflow_enrichment.html` shows the rendered output.
This workflow is based on four main functions, which respectively handle the preparation of gene sets, the identification of DE parameters, the computation of enrichment analyses, and the visualization of results.

---

## Functions

`Prepare_Enrichment` prepares gene sets from various sources including Hallmarks, KEGG, Reactome, and MitoCarta. It organizes them into structured biological groups and returns a combined list ready for downstream enrichment analysis. This function handles both human and mouse genes, converting orthologs when necessary.

`Identification_DEmethod` identifies the differential expression (DE) method used (DESeq2, limma, or proDA) based on the input data columns and returns the relevant column names for p-values, fold changes, gene identifiers, and ranking statistics. If parameters are provided by the user, the function uses those instead.

`Compute_Enrichment` performs enrichment analysis using the prepared gene sets and DE results. It supports GSEA, camera, and ORA methods, and applies multiple testing correction within each biological group. The function returns enrichment results organized by pathway group and by comparison, including separate results for up- and down-regulated genes if ORA is used.

`Plot_Enrichment` generates publication-ready dot plots summarizing enrichment results. Each plot corresponds to a biological group and preserves the predefined ordering of pathways. The function also saves SVG plots and Excel tables with the underlying data.

---

## Additional Files

The repository includes a folder called `Sorted_pathways` which contains all the files defining the pathway groups (GROUPS) used by the functions. These files were manually curated according with the annotations reported in Reactome Pathway Database and in the literature. Additionally, two `.rds` files are also provided. These objects can be regenerated by running the corresponding steps in the R Markdown file; however, these steps can be skipped if preferred, and the saved `.rds` files can be used directly.

---
